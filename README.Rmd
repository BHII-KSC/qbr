---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# qbr

<!-- badges: start -->
<!-- badges: end -->

The goal of qbr is to make it easy to interact with Quickbase's JSON API.

## Installation

You can install the development version of qbr like so:

``` r
 library(devtools)
 install_github("BHII-KSC/qbr")
```

## Usage

It is often cumbersome to manually download data from Quickbase to work on it in R.
The run_report function makes it easy to extract report data via the Quickbase JSON API:

```{r}
library(qbr)

# Get data from a Quickbase report as a tibble
run_report(subdomain = "bhi",
       token = keyring::key_get("qb_example"),
       table_id = "bn9d8iesz",
       report_id = "7")

```

Notice that this function returns a tibble even though the payload from Quickbase
is non-tabular JSON. This function extracts data from the Quickbase report 
(recursively if needed to handle the API's auto-pagination) and then makes the
data tidy using 'tidyverse' principles. 


## Complex data types

This packages returns some field types slightly differently to a Quickbase report:
```{r echo = FALSE, results ='asis'}
library(tibble)
library(knitr)

kable(tribble(~`Field type`, ~`Returned data type`,
        "Multi-select text", "Semicolon-separated text",
        "User", "User's email address",
        "List-user", "Semicolon-separated email addresses"))
```


## Limitations

Some extended ASCII characters (codes 128-255) cannot be properly parsed when 
converting from JSON at present, such as â€™ (&#146). Reports containing text and 
rich-text fields are the most likely to suffer an error resulting from the use of 
these extended characters. 

This package makes no attempt to convert data types. Number fields in Quickbase
may well be interpreted in the resulting tibble as characters. The run_report function
does provide a type_suffix argument to allow you to discern the intended datatype
more easily.
 
